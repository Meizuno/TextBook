import{O as b,P as y,au as q,T as c,a2 as p,Z as i,ao as x,am as F,r as S,S as V,j as U,as as B,e as Q,W as T,V as u,X as $,_ as g,a6 as j,at as N}from"./index-EkAxMetF.js";import{u as M,_ as O,a as P,Q as D}from"./NameInput.vue_vue_type_script_setup_true_lang-iHFY32iQ.js";import{a as A}from"./QIntersection-RGwNLVmW.js";import{u as E}from"./node-C7o2DFiP.js";const J=b({__name:"ContentInput",props:{modelValue:{type:String,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(f){const{t:d}=y(),t=q(f,"modelValue");return(e,a)=>(c(),p(x,{filled:"",autogrow:"",type:"textarea",modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=s=>t.value=s),label:i(d)("form.content"),rows:"3",hint:""},null,8,["modelValue","label"]))}}),W={class:"flex justify-end"},H=b({__name:"FileView",setup(f){const d=F(),{t}=y(),e=S(JSON.parse(V.getItem("selectedNode")??'{ "label": "", "path": "", "content": "", "type": "" }')),a={...e.value},s=e.value.type!=="file",_=U("pageTitle");_.value=t(s?"layout.createFile":"layout.editFile");const{success:r}=B(),{navigate:m}=A(),{createNode:w,editNode:h,deleteNode:C}=M(),{setActiveNode:v}=E(),I=async()=>{if(s){const l=await w(e.value.label.trim(),e.value.path,"file",e.value.content);l&&(v(l),r(t("notify.fileCreated")),await m("home"))}else{const l=await h(a.id,e.value.label.trim(),e.value.path,"file",e.value.content);l&&(v(l),r(t("notify.fileUpdated")),await m("home"))}},k=()=>{d.dialog({title:t("dialog.deleteFile"),message:t("dialog.deleteFileMessage"),cancel:!0,persistent:!0}).onOk(()=>{C(a.id,a.label,a.path,a.type,a.content).then(async()=>{N.getItem("activeNode")===a.id&&N.setItem("activeNode",0),r(t("notify.fileDelete")),await m("home")}).catch(()=>{console.error("Error deleting file")})})};return Q(()=>{V.removeItem("selectedNode")}),(l,o)=>(c(),p(D,{onSubmit:I,class:"q-gutter-md q-pa-lg"},{default:T(()=>[u(O,{modelValue:e.value.label,"onUpdate:modelValue":o[0]||(o[0]=n=>e.value.label=n)},null,8,["modelValue"]),u(P,{modelValue:e.value.path,"onUpdate:modelValue":o[1]||(o[1]=n=>e.value.path=n)},null,8,["modelValue"]),u(J,{modelValue:e.value.content,"onUpdate:modelValue":o[2]||(o[2]=n=>e.value.content=n)},null,8,["modelValue"]),$("div",W,[i(s)?j("",!0):(c(),p(g,{key:0,label:i(t)("button.delete"),color:"negative",class:"q-ml-sm",onClick:k},null,8,["label"])),u(g,{label:i(t)("button.submit"),type:"submit",color:"primary",class:"q-ml-sm"},null,8,["label"])])]),_:1}))}});export{H as _};
