import{c as $,r as C,p as G,B as H,C as J,o as X,h as V,b as M,g as O,as as Z,x as E,e as ee,at as te,au as ae,a as x,K as ne,av as le,L as oe,aw as se,u as U,m as ue,a5 as re,ax as ie,ay as ce,al as A,az as I,N as z,aA as de,ar as W,w as fe,P as k,S as B,T as y,am as Y,U as g,aB as me,aC as w,aD as L,V as D,$ as P,Y as K,a3 as ve,s as R,ao as T,ap as pe,aE as be,aF as ye,Q as he,a0 as ge,W as ke,R as qe}from"./index-3eUfLIpM.js";const we=$({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:n,emit:u}){const r=O(),a=C(null);let s=0;const i=[];function m(l){const p=typeof l=="boolean"?l:e.noErrorFocus!==!0,h=++s,_=(t,f)=>{u(`validation${t===!0?"Success":"Error"}`,f)},S=t=>{const f=t.validate();return typeof f.then=="function"?f.then(b=>({valid:b,comp:t}),b=>({valid:!1,comp:t,err:b})):Promise.resolve({valid:f,comp:t})};return(e.greedy===!0?Promise.all(i.map(S)).then(t=>t.filter(f=>f.valid!==!0)):i.reduce((t,f)=>t.then(()=>S(f).then(b=>{if(b.valid===!1)return Promise.reject(b)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return h===s&&_(!0),!0;if(h===s){const{comp:f,err:b}=t[0];if(b!==void 0&&console.error(b),_(!1,f),p===!0){const N=t.find(({comp:Q})=>typeof Q.focus=="function"&&Z(Q.$)===!1);N!==void 0&&N.comp.focus()}}return!1})}function d(){s++,i.forEach(l=>{typeof l.resetValidation=="function"&&l.resetValidation()})}function c(l){l!==void 0&&E(l);const p=s+1;m().then(h=>{p===s&&h===!0&&(e.onSubmit!==void 0?u("submit",l):l!==void 0&&l.target!==void 0&&typeof l.target.submit=="function"&&l.target.submit())})}function o(l){l!==void 0&&E(l),u("reset"),ee(()=>{d(),e.autofocus===!0&&e.noResetFocus!==!0&&v()})}function v(){te(()=>{if(a.value===null)return;const l=a.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||a.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||a.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(a.value.querySelectorAll("[tabindex]"),p=>p.tabIndex!==-1);l?.focus({preventScroll:!0})})}G(ae,{bindComponent(l){i.push(l)},unbindComponent(l){const p=i.indexOf(l);p!==-1&&i.splice(p,1)}});let q=!1;return H(()=>{q=!0}),J(()=>{q===!0&&e.autofocus===!0&&v()}),X(()=>{e.autofocus===!0&&v()}),Object.assign(r.proxy,{validate:m,resetValidation:d,submit:c,reset:o,focus:v,getValidationComponents:()=>i}),()=>V("form",{class:"q-form",ref:a,onSubmit:c,onReset:o},M(n.default))}}),xe=$({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:n}){const u=x(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>V("div",{class:u.value},M(n.default))}}),Ce=$({name:"QItem",props:{...ne,...le,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(e,{slots:n,emit:u}){const{proxy:{$q:r}}=O(),a=oe(e,r),{hasLink:s,linkAttrs:i,linkClass:m,linkTag:d,navigateOnClick:c}=se(),o=C(null),v=C(null),q=x(()=>e.clickable===!0||s.value===!0||e.tag==="label"),l=x(()=>e.disable!==!0&&q.value===!0),p=x(()=>"q-item q-item-type row no-wrap"+(e.dense===!0?" q-item--dense":"")+(a.value===!0?" q-item--dark":"")+(s.value===!0&&e.active===null?m.value:e.active===!0?` q-item--active${e.activeClass!==void 0?` ${e.activeClass}`:""}`:"")+(e.disable===!0?" disabled":"")+(l.value===!0?" q-item--clickable q-link cursor-pointer "+(e.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(e.focused===!0?" q-manual-focusable--focused":""):"")),h=x(()=>e.insetLevel===void 0?null:{["padding"+(r.lang.rtl===!0?"Right":"Left")]:16+e.insetLevel*56+"px"});function _(t){l.value===!0&&(v.value!==null&&(t.qKeyEvent!==!0&&document.activeElement===o.value?v.value.focus():document.activeElement===v.value&&o.value.focus()),c(t))}function S(t){if(l.value===!0&&U(t,[13,32])===!0){E(t),t.qKeyEvent=!0;const f=new MouseEvent("click",t);f.qKeyEvent=!0,o.value.dispatchEvent(f)}u("keyup",t)}function F(){const t=ue(n.default,[]);return l.value===!0&&t.unshift(V("div",{class:"q-focus-helper",tabindex:-1,ref:v})),t}return()=>{const t={ref:o,class:p.value,style:h.value,role:"listitem",onClick:_,onKeyup:S};return l.value===!0?(t.tabindex=e.tabindex||"0",Object.assign(t,i.value)):q.value===!0&&(t["aria-disabled"]="true"),V(d.value,t,F())}}});function j(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const n=parseInt(e,10);return isNaN(n)?0:n}const _e=re({name:"close-popup",beforeMount(e,{value:n}){const u={depth:j(n),handler(r){u.depth!==0&&setTimeout(()=>{const a=ie(e);a!==void 0&&ce(a,r,u.depth)})},handlerKey(r){U(r,13)===!0&&u.handler(r)}};e.__qclosepopup=u,e.addEventListener("click",u.handler),e.addEventListener("keyup",u.handlerKey)},updated(e,{value:n,oldValue:u}){n!==u&&(e.__qclosepopup.depth=j(n))},beforeUnmount(e){const n=e.__qclosepopup;e.removeEventListener("click",n.handler),e.removeEventListener("keyup",n.handlerKey),delete e.__qclosepopup}});function Se(){const{setTree:e}=A();return{createNode:async a=>{const s={label:a.label,path:a.path,content:a.content,type:a.type,children:[]};await I.post("/item",s),await e()},editNode:async(a,s)=>{const i={label:a.label,path:a.path,content:a.content,type:a.type,children:[]},m={label:s.label,path:s.path,content:s.content,type:s.type,children:[]};await I.put("/item",{old_item:i,new_item:m}),await e()},getFolders:(a,s)=>{const i=[],m=c=>{for(const o of c)o.path===a&&o.type==="directory"&&o.label!==s&&i.push(o.label),o.children&&m(o.children)},{tree:d}=A();return m(d),i}}}const Ve={key:0,class:"text-center text-grey-7"},Ee=z({__name:"PathInput",props:de({label:{type:String,required:!0}},{modelValue:{type:String,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const n=W(e,"modelValue"),u=e,{getFolders:r}=Se(),a=C(r(n.value,u.label)),s=C(!1);fe(n,()=>{a.value=r(n.value,u.label)});const i=()=>{n.value=n.value.split("/").slice(0,-1).join("/")||"/"},m=d=>{n.value=n.value.replace(/\/?$/,"/")+d};return(d,c)=>(k(),B(T,null,[y(Y,{filled:"",type:"text",modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=o=>n.value=o),label:"Path",onClick:c[1]||(c[1]=o=>s.value=!0),readonly:"",hint:""},null,8,["modelValue"]),y(ye,{modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=o=>s.value=o)},{default:g(()=>[y(me,{class:w([d.$q.dark.isActive?"bg-dark text-white":"bg-white text-dark","w-80 shadow-lg rounded-md"])},{default:g(()=>[y(L,{class:w([d.$q.dark.isActive?"bg-grey-9 text-white":"bg-primary text-white","flex justify-between"])},{default:g(()=>[c[3]||(c[3]=D("div",{class:"text-h6"},"Path",-1)),D("div",null,[n.value!=="/"?(k(),P(K,{key:0,flat:"",color:d.$q.dark.isActive?"primary":"white",label:"Back",onClick:i},null,8,["color"])):ve("",!0),R(y(K,{flat:"",color:d.$q.dark.isActive?"primary":"white",label:"OK"},null,8,["color"]),[[_e]])])]),_:1},8,["class"]),y(L,{class:"p-4"},{default:g(()=>[a.value.length===0?(k(),B("div",Ve," No folders ")):(k(!0),B(T,{key:1},pe(a.value,o=>R((k(),P(Ce,{key:o,clickable:"",class:w([d.$q.dark.isActive?"hover:bg-grey-7":"hover:bg-grey-2","rounded-md"]),onClick:v=>m(o)},{default:g(()=>[y(he,{color:"primary",name:"folder",size:"md",class:"q-mr-sm"}),y(xe,null,{default:g(()=>[ge(ke(o),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),[[qe]])),128))]),_:1}),y(be)]),_:1},8,["class"])]),_:1},8,["modelValue"])],64))}}),Pe=z({__name:"NameInput",props:{modelValue:{type:String,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(e){const n=W(e,"modelValue");return(u,r)=>(k(),P(Y,{filled:"",clearable:"",type:"text",modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=a=>n.value=a),label:"Name",rules:[a=>a&&a.length>0]},null,8,["modelValue","rules"]))}});export{we as Q,Pe as _,Ee as a,Se as u};
