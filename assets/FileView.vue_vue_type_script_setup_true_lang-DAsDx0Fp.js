import{N as b,aq as U,O as c,a0 as p,X as i,al as k,r as x,P as V,f as F,d as B,U as Q,T as u,V as S,Y as g,a4 as T,ap as N}from"./index-DUrGJN2_.js";import{u as $,_ as M,a as O,Q as P}from"./NameInput.vue_vue_type_script_setup_true_lang-Dwn2Od_k.js";import{a as j}from"./QIntersection-Cp4GYU95.js";import{u as D}from"./useNotify-BsPaTxiY.js";import{u as y}from"./vue-i18n-oM_WjuWh.js";import{u as A}from"./node-B7efAya7.js";import{u as E}from"./use-quasar-Ci2ICE00.js";const J=b({__name:"ContentInput",props:{modelValue:{type:String,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(f){const{t:r}=y(),t=U(f,"modelValue");return(e,a)=>(c(),p(k,{filled:"",autogrow:"",type:"textarea",modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=s=>t.value=s),label:i(r)("form.content"),rows:"3",hint:""},null,8,["modelValue","label"]))}}),X={class:"flex justify-end"},W=b({__name:"FileView",setup(f){const r=E(),{t}=y(),e=x(JSON.parse(V.getItem("selectedNode")??'{ "label": "", "path": "", "content": "", "type": "" }')),a={...e.value},s=e.value.type!=="file",_=F("pageTitle");_.value=t(s?"layout.createFile":"layout.editFile");const{success:d}=D(),{navigate:m}=j(),{createNode:w,editNode:h,deleteNode:q}=$(),{setActiveNode:v}=A(),C=async()=>{if(s){const l=await w(e.value.label.trim(),e.value.path,"file",e.value.content);l&&(v(l),d(t("notify.fileCreated")),await m("home"))}else{const l=await h(a.id,e.value.label.trim(),e.value.path,"file",e.value.content);l&&(v(l),d(t("notify.fileUpdated")),await m("home"))}},I=()=>{r.dialog({title:t("dialog.deleteFile"),message:t("dialog.deleteFileMessage"),cancel:!0,persistent:!0}).onOk(()=>{q(a.id,a.label,a.path,a.type,a.content).then(async()=>{N.getItem("activeNode")===a.id&&N.setItem("activeNode",0),d(t("notify.fileDelete")),await m("home")}).catch(()=>{console.error("Error deleting file")})})};return B(()=>{V.removeItem("selectedNode")}),(l,o)=>(c(),p(P,{onSubmit:C,class:"q-gutter-md q-pa-lg"},{default:Q(()=>[u(M,{modelValue:e.value.label,"onUpdate:modelValue":o[0]||(o[0]=n=>e.value.label=n)},null,8,["modelValue"]),u(O,{modelValue:e.value.path,"onUpdate:modelValue":o[1]||(o[1]=n=>e.value.path=n)},null,8,["modelValue"]),u(J,{modelValue:e.value.content,"onUpdate:modelValue":o[2]||(o[2]=n=>e.value.content=n)},null,8,["modelValue"]),S("div",X,[i(s)?T("",!0):(c(),p(g,{key:0,label:i(t)("button.delete"),color:"negative",class:"q-ml-sm",onClick:I},null,8,["label"])),u(g,{label:i(t)("button.submit"),type:"submit",color:"primary",class:"q-ml-sm"},null,8,["label"])])]),_:1}))}});export{W as _};
