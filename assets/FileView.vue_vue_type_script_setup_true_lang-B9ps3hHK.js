import{O as b,P as y,au as k,a1 as c,U as p,ao as q,Z as i,am as x,r as F,S as V,j as S,as as B,e as Q,W as $,V as u,X as j,a2 as M,_ as g,at as N}from"./index-CoXF0w-J.js";import{u as O,Q as P,_ as T,a as D}from"./NameInput.vue_vue_type_script_setup_true_lang-BBkf-L-l.js";import{a as A}from"./QIntersection-Nt0EuJ0N.js";import{u as E}from"./node-BSbTzwFX.js";const J=b({__name:"ContentInput",props:{modelValue:{type:String,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(f){const{t:d}=y(),t=k(f,"modelValue");return(e,a)=>(p(),c(q,{filled:"",autogrow:"",type:"textarea",modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=s=>t.value=s),label:i(d)("form.content"),rows:"3",hint:""},null,8,["modelValue","label"]))}}),W={class:"flex justify-end"},H=b({__name:"FileView",setup(f){const d=x(),{t}=y(),e=F(JSON.parse(V.getItem("selectedNode")??'{ "label": "", "path": "", "content": "", "type": "" }')),a={...e.value},s=e.value.type!=="file",_=S("pageTitle");_.value=t(s?"layout.createFile":"layout.editFile");const{success:r}=B(),{navigate:m}=A(),{createNode:w,editNode:h,deleteNode:C}=O(),{setActiveNode:v}=E(),I=async()=>{if(s){const l=await w(e.value.label.trim(),e.value.path,"file",e.value.content);l&&(v(l),r(t("notify.fileCreated")),await m("home"))}else{const l=await h(a.id,e.value.label.trim(),e.value.path,"file",e.value.content);l&&(v(l),r(t("notify.fileUpdated")),await m("home"))}},U=()=>{d.dialog({title:t("dialog.deleteFile"),message:t("dialog.deleteFileMessage"),cancel:!0,persistent:!0}).onOk(()=>{C(a.id,a.label,a.path,a.type,a.content).then(async()=>{N.getItem("activeNode")===a.id&&N.setItem("activeNode",0),r(t("notify.fileDelete")),await m("home")}).catch(()=>{console.error("Error deleting file")})})};return Q(()=>{V.removeItem("selectedNode")}),(l,o)=>(p(),c(P,{onSubmit:I,class:"q-gutter-md q-pa-lg"},{default:$(()=>[u(T,{modelValue:e.value.label,"onUpdate:modelValue":o[0]||(o[0]=n=>e.value.label=n)},null,8,["modelValue"]),u(D,{modelValue:e.value.path,"onUpdate:modelValue":o[1]||(o[1]=n=>e.value.path=n)},null,8,["modelValue"]),u(J,{modelValue:e.value.content,"onUpdate:modelValue":o[2]||(o[2]=n=>e.value.content=n)},null,8,["modelValue"]),j("div",W,[i(s)?M("",!0):(p(),c(g,{key:0,label:i(t)("button.delete"),color:"negative",class:"q-ml-sm",onClick:U},null,8,["label"])),u(g,{label:i(t)("button.submit"),type:"submit",color:"primary",class:"q-ml-sm"},null,8,["label"])])]),_:1}))}});export{H as _};
