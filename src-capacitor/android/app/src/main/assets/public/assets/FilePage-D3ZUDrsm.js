import{K as F,a4 as T,M as U,r as i,a6 as j,a5 as A,o as I,d as _,O as n,P as b,S as s,T as a,a8 as m,X as u,ad as z,ae as D,af as c,ag as g,aa as w,s as y,ac as p,a7 as R,ah as K,ai as M,aj as O,Q as E,U as L,ab as X,R as G}from"./index-B2sqISku.js";import{Q as H,C as J,a as W,b as Y}from"./ClosePopup-CiTxKZOC.js";import{Q as Z}from"./QPage-DP0ickp0.js";import{u as h}from"./node-B0XvSiwp.js";import{a as ee}from"./useNavigation-BWspNTU1.js";import{u as ae}from"./useNode-DOyavTh_.js";import{m as le}from"./github-markdown-BQ9O_dh8.js";const te={class:"row justify-between"},pe=F({__name:"FilePage",setup(se){const k=T(),{selectedNode:e}=U(h()),{unselectNode:Q}=h(),V={...e.value},N=i(!e.value.label),o=i([]),d=i(!1),{success:v}=j(),{setTree:C}=A(),{navigate:x}=ee(),{createNode:S,editNode:q,getFolders:f}=ae();I(()=>{o.value=f(e.value.path,e.value.label),e.value.path!=="/"&&(o.value=["..",...o.value])});const P=r=>{r===".."?e.value.path=e.value.path.split("/").slice(0,-1).join("/")||"/":e.value.path=e.value.path.replace(/\/?$/,"/")+r,o.value=f(e.value.path,e.value.label),e.value.path!=="/"&&(o.value=["..",...o.value])},$=async()=>{N.value?(await S(e.value),v("File created")):(await q(V,e.value),v("File updated")),await C(),await x("home")},B=async()=>{k.dialog({message:await le(e.value.content),html:!0,class:"markdown-body"})};return _(()=>{Q()}),(r,l)=>(n(),b(Z,null,{default:s(()=>[a(H,{onSubmit:$,class:"q-gutter-md q-pa-lg"},{default:s(()=>[a(m,{filled:"",clearable:"",type:"text",modelValue:u(e).label,"onUpdate:modelValue":l[0]||(l[0]=t=>u(e).label=t),label:"Name"},null,8,["modelValue"]),a(m,{filled:"",type:"text",modelValue:u(e).path,"onUpdate:modelValue":l[1]||(l[1]=t=>u(e).path=t),label:"Path",onClick:l[2]||(l[2]=t=>d.value=!0),readonly:""},null,8,["modelValue"]),a(z,{modelValue:d.value,"onUpdate:modelValue":l[3]||(l[3]=t=>d.value=t)},{default:s(()=>[a(D,{class:c([r.$q.dark.isActive?"bg-dark text-white":"bg-white text-dark","w-80 shadow-lg rounded-md"])},{default:s(()=>[a(g,{class:c([r.$q.dark.isActive?"bg-grey-9 text-white":"bg-primary text-white","flex justify-between"])},{default:s(()=>[l[5]||(l[5]=w("div",{class:"text-h6"},"Path",-1)),y(a(p,{flat:"",color:r.$q.dark.isActive?"primary":"white",label:"OK"},null,8,["color"]),[[J]])]),_:1},8,["class"]),a(g,{class:"p-4"},{default:s(()=>[(n(!0),R(M,null,K(o.value,t=>y((n(),b(W,{key:t,clickable:"",class:c([r.$q.dark.isActive?"hover:bg-grey-7":"hover:bg-grey-2","rounded-md"]),onClick:oe=>P(t)},{default:s(()=>[a(E,{color:"primary",name:"folder",size:"md",class:"q-mr-sm"}),a(Y,null,{default:s(()=>[L(X(t),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),[[G]])),128))]),_:1}),a(O)]),_:1},8,["class"])]),_:1},8,["modelValue"]),a(m,{filled:"",autogrow:"",type:"textarea",modelValue:u(e).content,"onUpdate:modelValue":l[4]||(l[4]=t=>u(e).content=t),label:"Text",rows:"3"},null,8,["modelValue"]),w("div",te,[a(p,{color:"secondary",disable:!u(e)?.content,round:"",size:"12px",icon:"remove_red_eye",onClick:B},null,8,["disable"]),a(p,{label:"Submit",type:"submit",color:"primary",class:"q-ml-sm"})])]),_:1})]),_:1}))}});export{pe as default};
